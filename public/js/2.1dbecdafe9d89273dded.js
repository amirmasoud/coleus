webpackJsonp([2],{"03v1":function(e,t,n){var i=n("S3fp");"string"==typeof i&&(i=[[e.i,i,""]]);var r={transform:void 0};n("MTIv")(i,r);i.locals&&(e.exports=i.locals)},"4lTM":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r,s=n("tlQw"),o=n.n(s),l=n("8jLZ"),a=(n("03v1"),i=["query Book($slug: String) {\n        book(slug: $slug) {\n          id\n          pages {\n            id\n            title\n            is_header\n          }\n        }\n      }\n      "],r=["query Book($slug: String) {\n        book(slug: $slug) {\n          id\n          pages {\n            id\n            title\n            is_header\n          }\n        }\n      }\n      "],Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(r)}})));var c={components:{DynamicScroller:l.a,DynamicScrollerItem:l.b},created:function(){this.height=window.innerHeight-200+"px"},data:function(){return{slug:this.$route.params.slug,book:null,height:null,title:""}},apollo:{book:Object.freeze({query:o()(a),variables:function(){return{slug:this.slug}}})},methods:{getFirstId:function(e){for(var t=e.length-1;t>=0;t--)if(!e[t].is_header)return e[t].id},bookContents:function(e){if(this.title){var t=this.title;return e.filter(function(e){return e.title.includes(t)})}return e}}},d={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.book?n("b-row",[n("b-col",{attrs:{cols:"12",sm:"4",md:"4"}},[n("b-form-input",{attrs:{type:"search",placeholder:e.$t("search_title")},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),e._v(" "),n("hr"),e._v(" "),n("div",{staticClass:"book-contents",style:"height: "+e.height},[n("b-list-group",[n("DynamicScroller",{staticClass:"scroller",attrs:{items:e.bookContents(e.book.pages),"min-item-height":48,"page-mode":""},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.item,r=t.index,s=t.active;return[n("DynamicScrollerItem",{attrs:{item:i,active:s,"size-dependencies":[i.title],"data-index":r}},[i.is_header?n("b-list-group-item",{staticClass:"text-left",staticStyle:{"background-color":"transparent",border:"none"}},[e._v("\n                "+e._s(i.title)+"\n              ")]):n("b-list-group-item",{attrs:{to:{name:"books.read",params:{slug:e.slug,page:i.id}}}},[e._v("\n                "+e._s(i.title)+"\n              ")])],1)]}}])})],1)],1)],1),e._v(" "),n("b-col",{attrs:{cols:"12",sm:"8",md:"8"}},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("router-view",{key:e.$route.fullPath,attrs:{firstId:e.getFirstId(e.book.pages)}})],1)],1)],1):n("div",{staticClass:"my-4 text-center"},[n("img",{attrs:{src:"/svg-loaders/oval.svg"}})])},staticRenderFns:[]};var u=n("VU/8")(c,d,!1,function(e){n("Z9pB")},"data-v-768a890c",null);t.default=u.exports},"8jLZ":function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return D}),n.d(t,"b",function(){return C});var i=n("I3G/"),r=(n.n(i),{itemsLimit:1e3});var s=void 0;function o(){o.init||(o.init=!0,s=-1!==function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var i=e.indexOf("Edge/");return i>0?parseInt(e.substring(i+5,e.indexOf(".",i)),10):-1}())}var l={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"resize-observer",attrs:{tabindex:"-1"}})},staticRenderFns:[],_scopeId:"data-v-b329ee4c",name:"resize-observer",methods:{notify:function(){this.$emit("notify")},addResizeHandlers:function(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.notify),this._w===this.$el.offsetWidth&&this._h===this.$el.offsetHeight||this.notify()},removeResizeHandlers:function(){this._resizeObject&&this._resizeObject.onload&&(!s&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.notify),delete this._resizeObject.onload)}},mounted:function(){var e=this;o(),this.$nextTick(function(){e._w=e.$el.offsetWidth,e._h=e.$el.offsetHeight});var t=document.createElement("object");this._resizeObject=t,t.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex",-1),t.onload=this.addResizeHandlers,t.type="text/html",s&&this.$el.appendChild(t),t.data="about:blank",s||this.$el.appendChild(t)},beforeDestroy:function(){this.removeResizeHandlers()}};var a={version:"0.4.4",install:function(e){e.component("resize-observer",l)}},c=null;"undefined"!=typeof window?c=window.Vue:void 0!==e&&(c=e.Vue),c&&c.use(a);var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),v=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)};var f=function(){function e(t,n,i){u(this,e),this.el=t,this.observer=null,this.frozen=!1,this.createObserver(n,i)}return h(e,[{key:"createObserver",value:function(e,t){var n,i,r,s,o,l,a,c=this;(this.observer&&this.destroyObserver(),this.frozen)||(this.options="function"==typeof(n=e)?{callback:n}:n,this.callback=this.options.callback,this.callback&&this.options.throttle&&(this.callback=(i=this.callback,r=this.options.throttle,s=void 0,o=void 0,l=void 0,(a=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];l=n,s&&e===o||(o=e,clearTimeout(s),s=setTimeout(function(){i.apply(void 0,[e].concat(v(l))),s=0},r))})._clear=function(){clearTimeout(s)},a)),this.oldResult=void 0,this.observer=new IntersectionObserver(function(e){var t=e[0];if(c.callback){var n=t.isIntersecting&&t.intersectionRatio>=c.threshold;if(n===c.oldResult)return;c.oldResult=n,c.callback(n,t),n&&c.options.once&&(c.frozen=!0,c.destroyObserver())}},this.options.intersection),t.context.$nextTick(function(){c.observer.observe(c.el)}))}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&this.options.intersection.threshold||0}}]),e}();function p(e,t,n){var i=t.value;if("undefined"==typeof IntersectionObserver)console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var r=new f(e,i,n);e._vue_visibilityState=r}}var m={bind:p,update:function(e,t,n){var i=t.value;if(!function e(t,n){if(t===n)return!0;if("object"===(void 0===t?"undefined":d(t))){for(var i in t)if(!e(t[i],n[i]))return!1;return!0}return!1}(i,t.oldValue)){var r=e._vue_visibilityState;r?r.createObserver(i,n):p(e,{value:i},n)}},unbind:function(e){var t=e._vue_visibilityState;t&&(t.destroyObserver(),delete e._vue_visibilityState)}};var y={version:"0.4.3",install:function(e){e.directive("observe-visibility",m)}},g=null;"undefined"!=typeof window?g=window.Vue:void 0!==e&&(g=e.Vue),g&&g.use(y);var b="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};var w,x=(function(e){var t,n;t=b,n=function(){var e=/(auto|scroll)/,t=function(e,n){return null===e.parentNode?n:t(e.parentNode,n.concat([e]))},n=function(e,t){return getComputedStyle(e,null).getPropertyValue(t)},i=function(t){return e.test(function(e){return n(e,"overflow")+n(e,"overflow-y")+n(e,"overflow-x")}(t))};return function(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(var n=t(e.parentNode,[]),r=0;r<n.length;r+=1)if(i(n[r]))return n[r];return document.scrollingElement||document.documentElement}}},e.exports?e.exports=n():t.Scrollparent=n()}(w={exports:{}},w.exports),w.exports),_=!1;if("undefined"!=typeof window){_=!1;try{var $=Object.defineProperty({},"passive",{get:function(){_=!0}});window.addEventListener("test",null,$)}catch(e){}}var I=0,S={name:"RecycleScroller",mixins:[{components:{ResizeObserver:l},directives:{ObserveVisibility:m},props:{items:{type:Array,required:!0},itemHeight:{type:Number,default:null},minItemHeight:{type:[Number,String],default:null},heightField:{type:String,default:"height"},typeField:{type:String,default:"type"},keyField:{type:String,default:"id"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1}},computed:{heights:function(){if(null===this.itemHeight){for(var e={"-1":{accumulator:0}},t=this.items,n=this.heightField,i=this.minItemHeight,r=0,s=void 0,o=0,l=t.length;o<l;o++)r+=s=t[o][n]||i,e[o]={accumulator:r,height:s};return e}}},beforeDestroy:function(){this.removeListeners()},methods:{getListenerTarget:function(){var e=x(this.$el);return e!==window.document.documentElement&&e!==window.document.body||(e=window),e},getScroll:function(){var e=this.$el,t=void 0;if(this.pageMode){var n=e.getBoundingClientRect(),i=-n.top,r=window.innerHeight;i<0&&(r+=i,i=0),i+r>n.height&&(r=n.height-i),t={top:i,bottom:i+r}}else t={top:e.scrollTop,bottom:e.scrollTop+e.clientHeight};return t},applyPageMode:function(){this.pageMode?this.addListeners():this.removeListeners()},addListeners:function(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,!!_&&{passive:!0}),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners:function(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem:function(e){var t=void 0;t=null===this.itemHeight?e>0?this.heights[e-1].accumulator:0:e*this.itemHeight,this.scrollToPosition(t)},scrollToPosition:function(e){this.$el.scrollTop=e},itemsLimitError:function(){var e=this;throw setTimeout(function(){console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",e.$el),console.log("Make sure the scroller has a fixed height and 'overflow-y' set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")}}}],data:function(){return{pool:[],totalHeight:0,ready:!1,hoverKey:null}},watch:{items:function(){this.updateVisibleItems(!0)},pageMode:function(){this.applyPageMode(),this.updateVisibleItems(!1)},heights:{handler:function(){this.updateVisibleItems(!1)},deep:!0}},created:function(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$isServer&&this.updateVisibleItems(!1)},mounted:function(){var e=this;this.applyPageMode(),this.$nextTick(function(){e.updateVisibleItems(!0),e.ready=!0})},methods:{addView:function(e,t,n,i,r){var s={item:n,top:0},o={id:I++,index:t,used:!0,key:i,type:r};return Object.defineProperty(s,"nr",{configurable:!1,value:o}),e.push(s),s},unuseView:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.$_unusedViews,i=e.nr.type,r=n.get(i);r||(r=[],n.set(i,r)),r.push(e),t||(e.nr.used=!1,e.top=-9999,this.$_views.delete(e.nr.key))},handleResize:function(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll:function(e){var t=this;this.$_scrollDirty||(this.$_scrollDirty=!0,requestAnimationFrame(function(){t.$_scrollDirty=!1,t.updateVisibleItems(!1).continuous||(clearTimeout(t.$_refreshTimout),t.$_refreshTimout=setTimeout(t.handleScroll,100))}))},handleVisibilityChange:function(e,t){var n=this;this.ready&&(e||0!==t.boundingClientRect.width||0!==t.boundingClientRect.height?(this.$emit("visible"),requestAnimationFrame(function(){n.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems:function(e){var t=this.itemHeight,n=this.typeField,i=this.keyField,s=this.items,o=s.length,l=this.heights,a=this.$_views,c=this.$_unusedViews,d=this.pool,u=void 0,h=void 0,v=void 0;if(o)if(this.$isServer)u=0,h=this.prerender,v=null;else{var f=this.getScroll(),p=this.buffer;if(f.top-=p,f.bottom+=p,null===t){var m=0,y=o-1,g=~~(o/2),b=void 0;do{b=g,l[g].accumulator<f.top?m=g:g<o-1&&l[g+1].accumulator>f.top&&(y=g),g=~~((m+y)/2)}while(g!==b);for(g<0&&(g=0),u=g,v=l[o-1].accumulator,h=g;h<o&&l[h].accumulator<f.bottom;h++);-1===h?h=s.length-1:++h>o&&(h=o)}else u=~~(f.top/t),h=Math.ceil(f.bottom/t),u<0&&(u=0),h>o&&(h=o),v=o*t}else u=h=v=0;h-u>r.itemsLimit&&this.itemsLimitError(),this.totalHeight=v;var w=void 0,x=u<=this.$_endIndex&&h>=this.$_startIndex,_=void 0;if(this.$_continuous!==x){if(x){a.clear(),c.clear();for(var $=0,I=d.length;$<I;$++)w=d[$],this.unuseView(w)}this.$_continuous=x}else if(x)for(var S=0,k=d.length;S<k;S++)(w=d[S]).nr.used&&(e&&(w.nr.index=s.findIndex(function(e){return i?e[i]===w.item[i]:e===w.item})),(-1===w.nr.index||w.nr.index<u||w.nr.index>=h)&&this.unuseView(w));x||(_=new Map);for(var A=void 0,V=void 0,z=void 0,D=void 0,C=u;C<h;C++){A=s[C];var R=i?A[i]:A;w=a.get(R),t||l[C].height?(w?w.nr.used=!0:(V=A[n],x?(z=c.get(V))&&z.length?((w=z.pop()).item=A,w.nr.used=!0,w.nr.index=C,w.nr.key=R,w.nr.type=V):w=this.addView(d,C,A,R,V):(z=c.get(V),D=_.get(V)||0,z&&D<z.length?((w=z[D]).item=A,w.nr.used=!0,w.nr.index=C,w.nr.key=R,w.nr.type=V,_.set(V,D+1)):(w=this.addView(d,C,A,R,V),this.unuseView(w,!0)),D++),a.set(R,w)),w.top=null===t?l[C-1].accumulator:C*t):w&&this.unuseView(w)}return this.$_startIndex=u,this.$_endIndex=h,this.emitUpdate&&this.$emit("update",u,h),{continuous:x}}}},k=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:e.handleVisibilityChange,expression:"handleVisibilityChange"}],staticClass:"vue-recycle-scroller",class:{ready:e.ready,"page-mode":e.pageMode},on:{"&scroll":function(t){return e.handleScroll(t)}}},[e._t("before-container"),e._v(" "),n("div",{ref:"wrapper",staticClass:"vue-recycle-scroller__item-wrapper",style:{height:e.totalHeight+"px"}},e._l(e.pool,function(t){return n("div",{key:t.nr.id,staticClass:"vue-recycle-scroller__item-view",class:{hover:e.hoverKey===t.nr.key},style:e.ready?{transform:"translateY("+t.top+"px)"}:null,on:{mouseenter:function(n){e.hoverKey=t.nr.key},mouseleave:function(t){e.hoverKey=null}}},[e._t("default",null,{item:t.item,index:t.nr.index,active:t.nr.used})],2)})),e._v(" "),e._t("after-container"),e._v(" "),n("resize-observer",{on:{notify:e.handleResize}})],2)};k._withStripped=!0;var A=function(e,t,n,i,r,s,o,l){var a=("function"==typeof n?n.options:n)||{};a.__file="/home/akryum/Projects/vue-virtual-scroller/src/components/RecycleScroller.vue",a.render||(a.render=e.render,a.staticRenderFns=e.staticRenderFns,a._compiled=!0,r&&(a.functional=!0)),a._scopeId=i;var c=void 0;if(t&&(c=function(e){t.call(this,o(e))}),void 0!==c)if(a.functional){var d=a.render;a.render=function(e,t){return c.call(t),d(e,t)}}else{var u=a.beforeCreate;a.beforeCreate=u?[].concat(u,c):[c]}return a}({render:k,staticRenderFns:[]},function(e){e&&e("data-v-211f9c10_0",{source:"\n.vue-recycle-scroller:not(.page-mode) {\n  overflow-y: auto;\n}\n.vue-recycle-scroller__item-wrapper {\n  box-sizing: border-box;\n  width: 100%;\n  overflow: hidden;\n  position: relative;\n}\n.vue-recycle-scroller.ready .vue-recycle-scroller__item-view {\n  width: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  will-change: transform;\n}\n",map:{version:3,sources:["/home/akryum/Projects/vue-virtual-scroller/src/components/RecycleScroller.vue"],names:[],mappings:";AAoXA;EACA,iBAAA;CACA;AAEA;EACA,uBAAA;EACA,YAAA;EACA,iBAAA;EACA,mBAAA;CACA;AAEA;EACA,YAAA;EACA,mBAAA;EACA,OAAA;EACA,QAAA;EACA,uBAAA;CACA",file:"RecycleScroller.vue",sourcesContent:['<template>\n  <div\n    v-observe-visibility="handleVisibilityChange"\n    class="vue-recycle-scroller"\n    :class="{\n      ready,\n      \'page-mode\': pageMode,\n    }"\n    @scroll.passive="handleScroll"\n  >\n    <slot\n      name="before-container"\n    />\n\n    <div\n      ref="wrapper"\n      :style="{ height: totalHeight + \'px\' }"\n      class="vue-recycle-scroller__item-wrapper"\n    >\n      <div\n        v-for="view of pool"\n        :key="view.nr.id"\n        :style="ready ? { transform: \'translateY(\' + view.top + \'px)\' } : null"\n        class="vue-recycle-scroller__item-view"\n        :class="{ hover: hoverKey === view.nr.key }"\n        @mouseenter="hoverKey = view.nr.key"\n        @mouseleave="hoverKey = null"\n      >\n        <slot\n          :item="view.item"\n          :index="view.nr.index"\n          :active="view.nr.used"\n        />\n      </div>\n    </div>\n\n    <slot\n      name="after-container"\n    />\n\n    <resize-observer @notify="handleResize" />\n  </div>\n</template>\n\n<script>\nimport Scroller from \'../mixins/Scroller\'\nimport config from \'../config\'\n\nlet uid = 0\n\nexport default {\n  name: \'RecycleScroller\',\n\n  mixins: [\n    Scroller,\n  ],\n\n  data () {\n    return {\n      pool: [],\n      totalHeight: 0,\n      ready: false,\n      hoverKey: null,\n    }\n  },\n\n  watch: {\n    items () {\n      this.updateVisibleItems(true)\n    },\n\n    pageMode () {\n      this.applyPageMode()\n      this.updateVisibleItems(false)\n    },\n\n    heights: {\n      handler () {\n        this.updateVisibleItems(false)\n      },\n      deep: true,\n    },\n  },\n\n  created () {\n    this.$_startIndex = 0\n    this.$_endIndex = 0\n    this.$_views = new Map()\n    this.$_unusedViews = new Map()\n    this.$_scrollDirty = false\n\n    if (this.$isServer) {\n      this.updateVisibleItems(false)\n    }\n  },\n\n  mounted () {\n    this.applyPageMode()\n    this.$nextTick(() => {\n      this.updateVisibleItems(true)\n      this.ready = true\n    })\n  },\n\n  methods: {\n    addView (pool, index, item, key, type) {\n      const view = {\n        item,\n        top: 0,\n      }\n      const nonReactive = {\n        id: uid++,\n        index,\n        used: true,\n        key,\n        type,\n      }\n      Object.defineProperty(view, \'nr\', {\n        configurable: false,\n        value: nonReactive,\n      })\n      pool.push(view)\n      return view\n    },\n\n    unuseView (view, fake = false) {\n      const unusedViews = this.$_unusedViews\n      const type = view.nr.type\n      let unusedPool = unusedViews.get(type)\n      if (!unusedPool) {\n        unusedPool = []\n        unusedViews.set(type, unusedPool)\n      }\n      unusedPool.push(view)\n      if (!fake) {\n        view.nr.used = false\n        view.top = -9999\n        this.$_views.delete(view.nr.key)\n      }\n    },\n\n    handleResize () {\n      this.$emit(\'resize\')\n      if (this.ready) this.updateVisibleItems(false)\n    },\n\n    handleScroll (event) {\n      if (!this.$_scrollDirty) {\n        this.$_scrollDirty = true\n        requestAnimationFrame(() => {\n          this.$_scrollDirty = false\n          const { continuous } = this.updateVisibleItems(false)\n\n          // It seems sometimes chrome doesn\'t fire scroll event :/\n          // When non continous scrolling is ending, we force a refresh\n          if (!continuous) {\n            clearTimeout(this.$_refreshTimout)\n            this.$_refreshTimout = setTimeout(this.handleScroll, 100)\n          }\n        })\n      }\n    },\n\n    handleVisibilityChange (isVisible, entry) {\n      if (this.ready) {\n        if (isVisible || entry.boundingClientRect.width !== 0 || entry.boundingClientRect.height !== 0) {\n          this.$emit(\'visible\')\n          requestAnimationFrame(() => {\n            this.updateVisibleItems(false)\n          })\n        } else {\n          this.$emit(\'hidden\')\n        }\n      }\n    },\n\n    updateVisibleItems (checkItem) {\n      const itemHeight = this.itemHeight\n      const typeField = this.typeField\n      const keyField = this.keyField\n      const items = this.items\n      const count = items.length\n      const heights = this.heights\n      const views = this.$_views\n      let unusedViews = this.$_unusedViews\n      const pool = this.pool\n      let startIndex, endIndex\n      let totalHeight\n\n      if (!count) {\n        startIndex = endIndex = totalHeight = 0\n      } else if (this.$isServer) {\n        startIndex = 0\n        endIndex = this.prerender\n        totalHeight = null\n      } else {\n        const scroll = this.getScroll()\n        const buffer = this.buffer\n        scroll.top -= buffer\n        scroll.bottom += buffer\n\n        // Variable height mode\n        if (itemHeight === null) {\n          let h\n          let a = 0\n          let b = count - 1\n          let i = ~~(count / 2)\n          let oldI\n\n          // Searching for startIndex\n          do {\n            oldI = i\n            h = heights[i].accumulator\n            if (h < scroll.top) {\n              a = i\n            } else if (i < count - 1 && heights[i + 1].accumulator > scroll.top) {\n              b = i\n            }\n            i = ~~((a + b) / 2)\n          } while (i !== oldI)\n          i < 0 && (i = 0)\n          startIndex = i\n\n          // For container style\n          totalHeight = heights[count - 1].accumulator\n\n          // Searching for endIndex\n          for (endIndex = i; endIndex < count && heights[endIndex].accumulator < scroll.bottom; endIndex++);\n          if (endIndex === -1) {\n            endIndex = items.length - 1\n          } else {\n            endIndex++\n            // Bounds\n            endIndex > count && (endIndex = count)\n          }\n        } else {\n          // Fixed height mode\n          startIndex = ~~(scroll.top / itemHeight)\n          endIndex = Math.ceil(scroll.bottom / itemHeight)\n\n          // Bounds\n          startIndex < 0 && (startIndex = 0)\n          endIndex > count && (endIndex = count)\n\n          totalHeight = count * itemHeight\n        }\n      }\n\n      if (endIndex - startIndex > config.itemsLimit) {\n        this.itemsLimitError()\n      }\n\n      this.totalHeight = totalHeight\n\n      let view\n\n      const continuous = startIndex <= this.$_endIndex && endIndex >= this.$_startIndex\n      let unusedIndex\n\n      if (this.$_continuous !== continuous) {\n        if (continuous) {\n          views.clear()\n          unusedViews.clear()\n          for (let i = 0, l = pool.length; i < l; i++) {\n            view = pool[i]\n            this.unuseView(view)\n          }\n        }\n        this.$_continuous = continuous\n      } else if (continuous) {\n        for (let i = 0, l = pool.length; i < l; i++) {\n          view = pool[i]\n          if (view.nr.used) {\n            // Update view item index\n            if (checkItem) {\n              view.nr.index = items.findIndex(\n                item => keyField ? item[keyField] === view.item[keyField] : item === view.item\n              )\n            }\n\n            // Check if index is still in visible range\n            if (\n              view.nr.index === -1 ||\n              view.nr.index < startIndex ||\n              view.nr.index >= endIndex\n            ) {\n              this.unuseView(view)\n            }\n          }\n        }\n      }\n\n      if (!continuous) {\n        unusedIndex = new Map()\n      }\n\n      let item, type, unusedPool\n      let v\n      for (let i = startIndex; i < endIndex; i++) {\n        item = items[i]\n        const key = keyField ? item[keyField] : item\n        view = views.get(key)\n\n        if (!itemHeight && !heights[i].height) {\n          if (view) this.unuseView(view)\n          continue\n        }\n\n        // No view assigned to item\n        if (!view) {\n          type = item[typeField]\n\n          if (continuous) {\n            unusedPool = unusedViews.get(type)\n            // Reuse existing view\n            if (unusedPool && unusedPool.length) {\n              view = unusedPool.pop()\n              view.item = item\n              view.nr.used = true\n              view.nr.index = i\n              view.nr.key = key\n              view.nr.type = type\n            } else {\n              view = this.addView(pool, i, item, key, type)\n            }\n          } else {\n            unusedPool = unusedViews.get(type)\n            v = unusedIndex.get(type) || 0\n            // Use existing view\n            // We don\'t care if they are already used\n            // because we are not in continous scrolling\n            if (unusedPool && v < unusedPool.length) {\n              view = unusedPool[v]\n              view.item = item\n              view.nr.used = true\n              view.nr.index = i\n              view.nr.key = key\n              view.nr.type = type\n              unusedIndex.set(type, v + 1)\n            } else {\n              view = this.addView(pool, i, item, key, type)\n              this.unuseView(view, true)\n            }\n            v++\n          }\n          views.set(key, view)\n        } else {\n          view.nr.used = true\n        }\n\n        // Update position\n        if (itemHeight === null) {\n          view.top = heights[i - 1].accumulator\n        } else {\n          view.top = i * itemHeight\n        }\n      }\n\n      this.$_startIndex = startIndex\n      this.$_endIndex = endIndex\n\n      if (this.emitUpdate) this.$emit(\'update\', startIndex, endIndex)\n\n      return {\n        continuous,\n      }\n    },\n  },\n}\n<\/script>\n\n<style>\n.vue-recycle-scroller:not(.page-mode) {\n  overflow-y: auto;\n}\n\n.vue-recycle-scroller__item-wrapper {\n  box-sizing: border-box;\n  width: 100%;\n  overflow: hidden;\n  position: relative;\n}\n\n.vue-recycle-scroller.ready .vue-recycle-scroller__item-view {\n  width: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  will-change: transform;\n}\n</style>\n']},media:void 0})},S,void 0,!1,0,function e(){var t=document.head||document.getElementsByTagName("head")[0],n=e.styles||(e.styles={}),i="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(e,r){if(!document.querySelector('style[data-vue-ssr-id~="'+e+'"]')){var s=i?r.media||"default":e,o=n[s]||(n[s]={ids:[],parts:[],element:void 0});if(!o.ids.includes(e)){var l=r.source,a=o.ids.length;if(o.ids.push(e),i&&(o.element=o.element||document.querySelector("style[data-group="+s+"]")),!o.element){var c=o.element=document.createElement("style");c.type="text/css",r.media&&c.setAttribute("media",r.media),i&&(c.setAttribute("data-group",s),c.setAttribute("data-next-index","0")),t.appendChild(c)}if(i&&(a=parseInt(o.element.getAttribute("data-next-index")),o.element.setAttribute("data-next-index",a+1)),o.element.styleSheet)o.parts.push(l),o.element.styleSheet.cssText=o.parts.filter(Boolean).join("\n");else{var d=document.createTextNode(l),u=o.element.childNodes;u[a]&&o.element.removeChild(u[a]),u.length?o.element.insertBefore(d,u[a]):o.element.appendChild(d)}}}}}),V={name:"DynamicScroller",components:{RecycleScroller:A},inheritAttrs:!1,provide:function(){return{vscrollData:this.vscrollData,vscrollBus:this}},props:{items:{type:Array,required:!0},minItemHeight:{type:[Number,String],required:!0},keyField:{type:String,default:"id"}},data:function(){return{vscrollData:{active:!0,heights:{},keyField:this.keyField}}},computed:{itemsWithHeight:function(){for(var e=[],t=this.items,n=this.keyField,i=this.vscrollData.heights,r=0;r<t.length;r++){var s=t[r],o=s[n];e.push({item:s,id:o,height:i[o]||0})}return e},listeners:function(){var e={};for(var t in this.$listeners)"resize"!==t&&"visible"!==t&&(e[t]=this.$listeners[t]);return e}},watch:{items:"forceUpdate"},created:function(){this.$_updates=[]},mounted:function(){var e=this.$refs.scroller,t=this.getSize(e);this._scrollerWidth=t.width},activated:function(){this.vscrollData.active=!0},deactivated:function(){this.vscrollData.active=!1},methods:{onScrollerResize:function(){this.$refs.scroller&&this.forceUpdate(),this.$emit("resize")},onScrollerVisible:function(){this.$emit("vscroll:update",{force:!1}),this.$emit("visible")},forceUpdate:function(){this.vscrollData.heights={},this.$emit("vscroll:update",{force:!0})},getSize:function(e){return e.$el.getBoundingClientRect()},scrollToItem:function(e){var t=this.$refs.scroller;t&&t.scrollToItem(e)}}},z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("RecycleScroller",e._g(e._b({ref:"scroller",attrs:{items:e.itemsWithHeight,"min-item-height":e.minItemHeight},on:{resize:e.onScrollerResize,visible:e.onScrollerVisible},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item,i=t.index,r=t.active;return[e._t("default",null,null,{item:n.item,index:i,active:r,itemWithHeight:n})]}}])},"RecycleScroller",e.$attrs,!1),e.listeners),[n("template",{slot:"before-container"},[e._t("before-container")],2),e._v(" "),n("template",{slot:"after-container"},[e._t("after-container")],2)],2)};z._withStripped=!0;var D=function(e,t,n,i,r,s,o,l){var a=("function"==typeof n?n.options:n)||{};return a.__file="/home/akryum/Projects/vue-virtual-scroller/src/components/DynamicScroller.vue",a.render||(a.render=e.render,a.staticRenderFns=e.staticRenderFns,a._compiled=!0,r&&(a.functional=!0)),a._scopeId=i,a}({render:z,staticRenderFns:[]},0,V,void 0,!1);var C=function(e,t,n,i,r,s,o,l){var a=("function"==typeof n?n.options:n)||{};return a.__file="/home/akryum/Projects/vue-virtual-scroller/src/components/DynamicScrollerItem.vue",a.render||(a.render=e.render,a.staticRenderFns=e.staticRenderFns,a._compiled=!0,r&&(a.functional=!0)),a._scopeId=i,a}({},0,{name:"DynamicScrollerItem",inject:["vscrollData","vscrollBus"],props:{item:{type:Object,required:!0},watchData:{type:Boolean,default:!1},active:{type:Boolean,required:!0},sizeDependencies:{type:[Array,Object],default:null},emitResize:{type:Boolean,default:!1},tag:{type:String,default:"div"}},computed:{id:function(){return this.item[this.vscrollData.keyField]},height:function(){return this.vscrollData.heights[this.id]||0}},watch:{watchData:"updateWatchData",id:function(){this.height||this.onDataUpdate()},active:function(e){e&&this.$_pendingVScrollUpdate&&this.updateSize()}},created:function(){var e=this;if(!this.$isServer){this.$_forceNextVScrollUpdate=!1,this.updateWatchData();var t=function(t){e.$watch(function(){return e.sizeDependencies[t]},e.onDataUpdate)};for(var n in this.sizeDependencies)t(n);this.vscrollBus.$on("vscroll:update",this.onVscrollUpdate),this.vscrollBus.$on("vscroll:update-size",this.onVscrollUpdateSize)}},mounted:function(){this.vscrollData.active&&this.updateSize()},beforeDestroy:function(){this.vscrollBus.$off("vscroll:update",this.onVscrollUpdate),this.vscrollBus.$off("vscroll:update-size",this.onVscrollUpdateSize)},methods:{updateSize:function(){this.active&&this.vscrollData.active?this.$_pendingSizeUpdate||(this.$_pendingSizeUpdate=!0,this.$_forceNextVScrollUpdate=!1,this.$_pendingVScrollUpdate=!1,this.active&&this.vscrollData.active&&this.computeSize(this.id)):this.$_forceNextVScrollUpdate=!0},getSize:function(){return this.$el.getBoundingClientRect()},updateWatchData:function(){var e=this;this.watchData?this.$_watchData=this.$watch("data",function(){e.onDataUpdate()},{deep:!0}):this.$_watchData&&(this.$_watchData(),this.$_watchData=null)},onVscrollUpdate:function(e){var t=e.force;!this.active&&t&&(this.$_pendingVScrollUpdate=!0),(this.$_forceNextVScrollUpdate||t||!this.height)&&this.updateSize()},onDataUpdate:function(){this.updateSize()},computeSize:function(e){var t=this;this.$nextTick(function(){if(t.id===e){var n=t.getSize();n.height&&t.height!==n.height&&(t.$set(t.vscrollData.heights,t.id,n.height),t.emitResize&&t.$emit("resize",t.id))}t.$_pendingSizeUpdate=!1})}},render:function(e){return e(this.tag,this.$slots.default)}},void 0,void 0);var R={version:"1.0.0-beta.2",install:function(e,t){var n=Object.assign({},{installComponents:!0,componentsPrefix:""},t);for(var i in n)void 0!==n[i]&&(r[i]=n[i]);n.installComponents&&function(e,t){e.component(t+"recycle-scroller",A),e.component(t+"RecycleScroller",A),e.component(t+"dynamic-scroller",D),e.component(t+"DynamicScroller",D),e.component(t+"dynamic-scroller-item",C),e.component(t+"DynamicScrollerItem",C)}(e,n.componentsPrefix)}},H=null;"undefined"!=typeof window?H=window.Vue:void 0!==e&&(H=e.Vue),H&&H.use(R)}).call(t,n("DuR2"))},S3fp:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".virtual-scroller[data-v-727d6836]:not(.page-mode){overflow-y:auto}.item-container[data-v-727d6836]{box-sizing:border-box;width:100%;overflow:hidden}.items[data-v-727d6836]{width:100%}.recycle-list[data-v-68940351]:not(.page-mode){overflow-y:auto}.item-wrapper[data-v-68940351]{box-sizing:border-box;width:100%;overflow:hidden;position:relative}.item-view[data-v-68940351]{width:100%;position:absolute;top:0;left:0;will-change:transform}",""])},Z9pB:function(e,t,n){var i=n("s3Io");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("938282f8",i,!0,{})},s3Io:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".book-contents[data-v-768a890c]{overflow-y:scroll}.book-contents[data-v-768a890c]::-webkit-scrollbar{width:.3rem}.book-contents[data-v-768a890c]::-webkit-scrollbar-thumb{background-color:#a2a2a2}",""])}});
//# sourceMappingURL=2.1dbecdafe9d89273dded.js.map